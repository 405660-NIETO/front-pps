<!-- src/app/features/repair-request/repair-request.component.html -->
<div class="container py-4">
  
  <!-- Solicitud exitosa -->
  <div *ngIf="solicitudEnviada" class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card border-success">
        <div class="card-header bg-success text-white text-center">
          <h3><i class="bi bi-check-circle-fill"></i> ¬°Solicitud Enviada!</h3>
        </div>
        <div class="card-body text-center">
          <h4>Tu c√≥digo de referencia:</h4>
          <div class="alert alert-primary">
            <h2 class="mb-0">REP-{{reparacionId}}</h2>
          </div>
          
          <p class="lead">¬°Perfecto! Tu solicitud fue registrada exitosamente.</p>
          
          <div class="row mt-4">
            <div class="col-md-6">
              <h5><i class="bi bi-1-circle"></i> Pr√≥ximos pasos:</h5>
              <ul class="text-start">
                <li>Guard√° tu c√≥digo de referencia</li>
                <li>Ven√≠ al local con tu instrumento</li>
                <li>Mencion√° el c√≥digo <strong>REP-{{reparacionId}}</strong></li>
                <li>Hacemos diagn√≥stico gratuito</li>
              </ul>
            </div>
            <div class="col-md-6">
              <h5><i class="bi bi-clock"></i> Horarios:</h5>
              <p class="text-start">
                <strong>Lunes a S√°bado:</strong><br>
                9:00 - 18:00 hs<br><br>
                <strong>Domingos:</strong><br>
                Cerrado
              </p>
            </div>
          </div>
          
          <div class="alert alert-info mt-3">
            <i class="bi bi-info-circle"></i>
            <strong>Record√°:</strong> El diagn√≥stico es gratuito y sin compromiso. 
            Decid√≠ si continuar despu√©s de conocer el presupuesto.
          </div>
          
          <div class="d-flex gap-2 justify-content-center mt-4">
            <button class="btn btn-primary" (click)="nuevaSolicitud()">
              <i class="bi bi-plus"></i> Nueva Solicitud
            </button>
            <a routerLink="/" class="btn btn-outline-secondary">
              <i class="bi bi-house"></i> Volver al Inicio
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Formulario principal -->
  <div *ngIf="!solicitudEnviada" class="row">
    
    <!-- Columna izquierda: Informaci√≥n -->
    <div class="col-lg-6 mb-4">
      <!-- Hero con imagen -->
      <div class="position-relative mb-4">
        <img src="https://images.unsplash.com/photo-1655569614970-67d5579f1c60?q=80&w=2340&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" 
             alt="Reparaci√≥n de instrumentos" 
             class="img-fluid rounded shadow"
             style="height: 300px; width: 100%; object-fit: cover;">
        <div class="position-absolute top-0 start-0 w-100 h-100 bg-dark bg-opacity-25 rounded d-flex align-items-center justify-content-center">
          <h2 class="text-white text-center">üõ†Ô∏è Servicios de Reparaci√≥n</h2>
        </div>
      </div>

      <p class="lead">Especialistas en luter√≠a con a√±os de experiencia cuidando tu instrumento.</p>
      
      <h4><i class="bi bi-tools"></i> Nuestros Servicios:</h4>
      <div class="row">
        <div class="col-6">
          <ul class="list-unstyled">
            <li><i class="bi bi-check-circle text-success"></i> Cambio de cuerdas</li>
            <li><i class="bi bi-check-circle text-success"></i> Calibraci√≥n profesional</li>
            <li><i class="bi bi-check-circle text-success"></i> Reparaci√≥n de trastes</li>
          </ul>
        </div>
        <div class="col-6">
          <ul class="list-unstyled">
            <li><i class="bi bi-check-circle text-success"></i> Cambio de pastillas</li>
            <li><i class="bi bi-check-circle text-success"></i> Restauraci√≥n completa</li>
            <li><i class="bi bi-check-circle text-success"></i> Diagn√≥stico gratuito</li>
          </ul>
        </div>
      </div>
      
      <h4><i class="bi bi-list-ol"></i> ¬øC√≥mo funciona?</h4>
      <div class="timeline">
        <div class="d-flex mb-3">
          <span class="badge bg-primary rounded-circle me-3" style="width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;">1</span>
          <div>
            <strong>Complet√° el formulario</strong><br>
            <small class="text-muted">Contanos sobre tu instrumento y qu√© necesita</small>
          </div>
        </div>
        <div class="d-flex mb-3">
          <span class="badge bg-primary rounded-circle me-3" style="width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;">2</span>
          <div>
            <strong>Recib√≠ tu c√≥digo</strong><br>
            <small class="text-muted">Te damos un n√∫mero de referencia √∫nico</small>
          </div>
        </div>
        <div class="d-flex mb-3">
          <span class="badge bg-primary rounded-circle me-3" style="width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;">3</span>
          <div>
            <strong>Ven√≠ al local</strong><br>
            <small class="text-muted">Cuando te convenga, con tu instrumento</small>
          </div>
        </div>
        <div class="d-flex mb-3">
          <span class="badge bg-primary rounded-circle me-3" style="width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;">4</span>
          <div>
            <strong>Mencion√° tu c√≥digo</strong><br>
            <small class="text-muted">Proceso m√°s r√°pido y organizado</small>
          </div>
        </div>
      </div>
      
      <div class="alert alert-info">
        <i class="bi bi-info-circle"></i>
        <strong>Sin compromiso:</strong> El diagn√≥stico es gratuito y pod√©s decidir si continuar despu√©s de conocer el presupuesto.
      </div>
    </div>

    <!-- Columna derecha: Formulario -->
    <div class="col-lg-6">
      <div class="card shadow">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0"><i class="bi bi-clipboard"></i> Pre-Registro de Reparaci√≥n</h5>
        </div>
        <div class="card-body">
          
          <!-- Error general -->
          <div *ngIf="error" class="alert alert-danger">
            <i class="bi bi-exclamation-triangle"></i> {{error}}
          </div>

          <form [formGroup]="repairForm" (ngSubmit)="enviarSolicitud()">
            
            <!-- FORMULARIO SIMPLIFICADO - Solo 3 campos -->
            
            <!-- Campo 1: Datos de Contacto -->
            <div class="mb-4">
              <label class="form-label">
                <i class="bi bi-person-circle"></i> 
                Tus datos de contacto *
              </label>
              <textarea class="form-control" 
                        formControlName="datosContacto"
                        [class.is-invalid]="isFieldInvalid('datosContacto')"
                        rows="3"
                        maxlength="80"
                        placeholder="Inclu√≠ tu nombre, email y/o tel√©fono para que podamos contactarte...

Ejemplo:
Juan P√©rez - juanperez@email.com - 11-1234-5678"></textarea>
              <div class="invalid-feedback">{{getFieldError('datosContacto')}}</div>
              <div class="d-flex justify-content-between">
                <small class="text-muted">
                  <i class="bi bi-info-circle"></i>
                  Inclu√≠ al menos tu email o tel√©fono
                </small>
                <small class="text-muted">
                  {{repairForm.get('datosContacto')?.value?.length || 0}}/80 caracteres
                </small>
              </div>
            </div>

            <!-- Campo 2: Problema del Instrumento -->
            <div class="mb-4">
              <label class="form-label">
                <i class="bi bi-music-note-beamed"></i>
                ¬øQu√© problema tiene tu instrumento? *
              </label>
              <textarea class="form-control" 
                        formControlName="problemasReportados"
                        [class.is-invalid]="isFieldInvalid('problemasReportados')"
                        rows="4"
                        maxlength="120"
                        placeholder="Contanos sobre tu instrumento y qu√© le sucede...

Ejemplo:
Guitarra ac√∫stica Yamaha FG800 - ruido extra√±o en cuerdas graves, se desafina r√°pido"></textarea>
              <div class="invalid-feedback">{{getFieldError('problemasReportados')}}</div>
              <div class="d-flex justify-content-between">
                <small class="text-muted">
                  <i class="bi bi-lightbulb"></i>
                  Inclu√≠: tipo, marca y problema
                </small>
                <small class="text-muted">
                  {{repairForm.get('problemasReportados')?.value?.length || 0}}/120 caracteres
                </small>
              </div>
            </div>

            <!-- Campo 3: Fecha de Inicio -->
            <div class="mb-4">
              <label class="form-label">
                <i class="bi bi-calendar-check"></i>
                ¬øCu√°ndo pens√°s traer tu instrumento? *
              </label>
              <input type="date" 
                     class="form-control" 
                     formControlName="fechaInicio"
                     [class.is-invalid]="isFieldInvalid('fechaInicio')"
                     [min]="fechaMinima">
              <div class="invalid-feedback">{{getFieldError('fechaInicio')}}</div>
              <small class="text-muted">
                <i class="bi bi-clock"></i>
                Nos ayuda a organizarnos mejor para cuando llegues
              </small>
            </div>

            <!-- Botones -->
            <div class="d-grid gap-2 mt-4">
              <button type="submit" 
                      class="btn btn-success btn-lg"
                      [disabled]="repairForm.invalid || enviandoSolicitud">
                <span *ngIf="enviandoSolicitud" class="spinner-border spinner-border-sm me-2"></span>
                <i *ngIf="!enviandoSolicitud" class="bi bi-send"></i>
                {{enviandoSolicitud ? 'Enviando solicitud...' : 'Enviar Solicitud'}}
              </button>
              <a routerLink="/" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left"></i> Volver al Inicio
              </a>
            </div>

            <div class="text-center mt-3">
              <small class="text-muted">
                <i class="bi bi-shield-check"></i> 
                Tus datos est√°n seguros y solo se usan para contactarte sobre la reparaci√≥n
              </small>
            </div>

          </form>
        </div>
      </div>
    </div>

  </div> <!-- End row -->
</div> <!-- End container -->